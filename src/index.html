<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8"/>
    <title>PHP Interactive shell</title>
    <link rel="stylesheet" href="./dist/css/bootstrap.css"/>
    <script type="text/javascript" src="./dist/js/bootstrap.bundle.js"></script>
    <script type="text/javascript" src="./dist/js/bootstrap.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=BIZ+UDGothic&family=Fira+Code:wght@300..700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=M+PLUS+1+Code:wght@100..700&family=M+PLUS+1p&family=M+PLUS+2:wght@100..900&family=Noto+Sans+JP:wght@100..900&family=Roboto+Mono:ital,wght@0,100..700;1,100..700&family=Sawarabi+Gothic&family=Zen+Kaku+Gothic+New&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=BIZ+UDGothic&family=Fira+Code:wght@300..700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=M+PLUS+1p&family=M+PLUS+2:wght@100..900&family=Noto+Sans+JP:wght@100..900&family=Roboto+Mono:ital,wght@0,100..700;1,100..700&family=Sawarabi+Gothic&family=Zen+Kaku+Gothic+New&display=swap" rel="stylesheet">
    <style>
      * {
        font-family: "M PLUS 1 Code", monospace !important;
        font-weight: 450 !important;
        font-size: 11pt !important;
        /*letter-spacing: 0.05rem;*/
        margin: 0;
        padding: 0;
        tab-size: 4;
      }


      textarea {
        width: 100%;
      }

      textarea#php {
        font-family: "M PLUS 1 Code", monospace !important;
        font-optical-sizing: auto;
        font-style: normal;
        font-size: 12pt !important;
        width: 100%;
        height: 100%;
        background-color: #333;
        color: #EFEFEF;
        resize: vertical;
      }

      #php-response {
        font-size: 12pt !important;
        font-family: "M PLUS 1 Code", monospace !important;
        /*font-family: Cica, Consolas, monospace;*/
        color: #FFF;
        overflow: auto;
        word-wrap: break-word;
        word-break: break-all;
        text-align: justify;
        background-color: #333333;
      }

      #php-response.error {
        font-family: Cica, Consolas, monospace;
        color: red;
        height: 100%;
        word-wrap: break-word;
        word-break: break-all;
      }

      #current-php-version, #current-working-directory {
        border: 1px solid #DDD;
        padding: 3pt;
        border-radius: 3pt;
        margin-bottom: 0.3rem;
      }
    </style>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row">
        <div class="col-sm-6 col-md-8 order-1 order-md-1 ">
          <div>
            <p>選択中のPHP実行パス</p>
            <p id="current-php-version"></p>
            <p>選択中のPHP実行パス</p>
            <p id="current-working-directory"></p>
          </div>
        </div>
        <div class="col-sm-6 col-md-4  order-2 order-md-1 ">
          <div id="header-menu">
            <p id="save-temp-source">
              一時保存する
            </p>
          </div>
        </div>
      </div>


      <div class="row p-0 m-0">
        <div class=" p-0 m-0 col-sm-6 col-md-6  order-2 order-md-2 text-white overflow-auto">
          <pre class="bg-dark" id="php-response"></pre>
        </div>
        <div class="col-sm-6 col-md-6  order-2 order-md-1">
          <textarea class="form-control rounded-0" spellcheck="false" id="php"></textarea>
        </div>
      </div>
      <div class="row p-0 m-0">
        <div class="col-12  p-0 m-0" id="packets">

        </div>
      </div>
    </div>
    <script>
      function OnTabKey(e, obj) {

        // タブキーが押された時以外は即リターン
        if (e.keyCode !== 9) {
          return;
        }
        // タブキーを押したときのデフォルトの挙動を止める
        e.preventDefault();

        // 現在のカーソルの位置と、カーソルの左右の文字列を取得しておく
        const cursorPosition = obj.selectionStart;
        console.log(cursorPosition);
        const cursorLeft = obj.value.substring(0, cursorPosition);
        console.log(obj.value.length)
        const cursorRight = obj.value.substring(cursorPosition, obj.value.length);

        // テキストエリアの中身を、
        // 「取得しておいたカーソルの左側」+「タブ」+「取得しておいたカーソルの右側」
        // という状態にする。
        obj.value = cursorLeft + "\t" + cursorRight;

        // カーソルの位置を入力したタブの後ろにする
        obj.selectionEnd = cursorPosition + 1;
      }

      // 対象となるテキストエリアにonkeydownイベントを追加する
      document.getElementById("php").onkeydown = function (e) {
        OnTabKey(e, this);
      }

      function changedMethod(e) {
        const currentWindowMaxHeight = window.innerHeight;
        document.getElementById("php").style.height = currentWindowMaxHeight  + "px";
        document.getElementById("php-response").style.height = currentWindowMaxHeight + "px";
      }

      window.addEventListener("load", changedMethod);
      window.addEventListener("resize", changedMethod);
    </script>
    <script src="./renderer.js"></script>
  </body>
</html>
